!function(){"use strict";angular.module("mondido",["mondido.encryption","mondido.directives"])}(),function(){"use strict";angular.module("mondido.directives.cardNumber",[]).directive("cardNumber",["$window",function(){return{restrict:"A",require:"^form",link:function(a,b,c,d){function e(a,b){return b.validLength.indexOf(a.length)>-1}function f(b,c){-1==b.className.indexOf(c)&&a.$apply(function(){b.className+=" "+c})}function g(a){for(var b=a.val().replace(/\s/g,""),c=[],d=0;d<b.length;d+=4)c.push(b.substr(d,4));a.val(c.join(" "))}function h(a){d.$setValidity("credit-card",!0),a.addClass("ng-valid"),a.removeClass("ng-invalid")}function i(a){d.$setValidity("credit-card",!1),a.addClass("ng-invalid"),a.removeClass("ng-valid")}function j(a){var b,c=a.val().replace(/\s/g,"");for(var d in l){var g=l[d];if(b=c.match(g.pattern),null!==b)return f(a.get(0),g.name),e(c,g)?{valid:!0,cardType:g.name}:{valid:!1,cardType:g.name}}return null===b?{valid:!1,cardType:null}:void 0}function k(a){var b=j(a);b.valid?h(a):i(a)}var l=[{name:"amex",pattern:/^3[47]/,validLength:[15]},{name:"diners_club_carte_blanche",pattern:/^30[0-5]/,validLength:[14]},{name:"diners_club_international",pattern:/^36/,validLength:[14]},{name:"jcb",pattern:/^35(2[89]|[3-8][0-9])/,validLength:[16]},{name:"laser",pattern:/^(6304|670[69]|6771)/,validLength:[16,17,18,19]},{name:"visa_electron",pattern:/^(4026|417500|4508|4844|491(3|7))/,validLength:[16]},{name:"visa",pattern:/^4/,validLength:[16]},{name:"mastercard",pattern:/^5[1-5]/,validLength:[16]},{name:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,validLength:[12,13,14,15,16,17,18,19]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,validLength:[16]}];b.on("keyup",function(b){var c=$(b.target);-1===[37,38,39,40,16,17,18,91].indexOf(b.which)&&(console.log(b.which),a.$apply(function(){g(c)})),k(c)}),i(b)}}}])}(),function(){"use strict";angular.module("mondido.directives.paymentConfig",["mondido.encryption"]).directive("paymentConfig",["$window","encryptString",function(a,b){return{restrict:"A",link:function(c,d,e){function f(a){var d={},f=[],g=c[e.paymentConfig];"undefined"!=typeof g.encrypted_parameters&&$.isArray(g.encrypted_parameters)&&(f=g.encrypted_parameters);for(var h in a)d[h]=f.indexOf(h)>-1?b(a[h],g.public_key):a[h];return d.encrypted=f.join(","),d}function g(){var a,b=/MSIE\s([0-9]\.[0-9]);/,c=b.exec(navigator.userAgent);if(c){var d=parseFloat(c[1]);10>d&&(a=!0)}a?i():h()}function h(){function b(){n&&n.closed?c.$apply(function(){c.mondido.waitingForMpi=!1}):setTimeout(b,200)}n=a.open("","mpiwindow","width=640,height=480,top=200,left=500"),c.mondido.waitingForMpi=!0,b()}function i(){c.mondido.waitingForMpi=!0,c.$apply(function(){var a=$(document.createElement("div")).appendTo("body").attr("id","mpi-overlay");n=$(document.createElement("iframe")).css({width:640,height:480}).attr("id","mpi-iframe").attr("name","mpiwindow").appendTo(a)})}function j(){n.location?n.close():n.parent().remove(),n=null}function k(){var a=f(o),b=$(document.createElement("form")).attr("action","https://pay.mondido.com/v1/mpi_js").attr("method","POST").attr("target","mpiwindow").appendTo("body");for(var c in a)$(document.createElement("input")).attr("name",c).attr("type","hidden").val(o[c]).appendTo(b);b.submit()}function l(a){var b=null;try{b=$.parseJSON(a.data)}catch(d){return!1}return b&&"mpi"===b.event?(j(),c.$apply(function(){c.mondido.waitingForMpi=!1}),b.success&&(o.ref=b.mpi_ref,o.eci=b.eci,o.provider_ref=b.provider_ref,m()),void 0):!1}function m(){c.mondido.isLoading=!0;var a={type:"POST",url:p.url||"https://api.mondido.com/v1/transactions",data:f(o),success:function(a){c.$apply(function(){c.mondido.isLoading=!1}),"function"==typeof p.success&&(p.success(a),c.$digest())},error:function(a){c.$apply(function(){c.mondido.isLoading=!1}),"function"==typeof p.error&&(p.error(a.responseJSON||$.parseJSON(a.responseText)),c.$digest())},complete:function(a,b){"function"==typeof p.complete&&(p.complete(a,b),c.$digest())}};console.log(a),$.ajax(a)}var n,o=c[e.ngModel],p=c[e.paymentConfig];c.mondido={},a.addEventListener?a.addEventListener("message",l,!1):a.attachEvent("onmessage",l),window.XDomainRequest&&jQuery.ajaxTransport(function(a){if(a.crossDomain&&a.async){a.timeout&&(a.xdrTimeout=a.timeout,delete a.timeout);var b;return{send:function(c,d){function e(a,c,e,f){b.onload=b.onerror=b.ontimeout=jQuery.noop,b=void 0,d(a,c,e,f)}b=new XDomainRequest,b.onload=function(){e(200,"OK",{text:b.responseText},"Content-Type: "+b.contentType)},b.onerror=function(){e(404,"Not Found")},b.onprogress=jQuery.noop,b.ontimeout=function(){e(0,"timeout")},b.timeout=a.xdrTimeout||Number.MAX_VALUE,b.open(a.type,a.url),b.send(a.hasContent&&a.data||null)},abort:function(){b&&(b.onerror=jQuery.noop,b.abort())}}}}),d.bind("submit",function(){function a(){p.mpi!==!1?k():m()}p.mpi!==!1&&g(),p.prepare&&"function"==typeof p.prepare?p.prepare(a):a()})}}}])}(),function(){"use strict";angular.module("mondido.directives",["mondido.directives.cardNumber","mondido.directives.paymentConfig"])}(),angular.module("mondido.encryption",[]).factory("encryptString",function(){function a(){function a(a){a||(a=8);for(var b=new Array(a),c=[],d=0;256>d;d++)c[d]=d;for(d=0;d<b.length;d++)b[d]=c[Math.floor(Math.random()*c.length)];return b}this.setDefaults=function(){this.params.nBits=256,this.params.salt=a(8),this.params.salt=uc.byteArray2String(this.params.salt),this.params.salt=uc.convertToHex(this.params.salt),this.params.blockSize=16,this.params.UTF8=!0,this.params.A0_PAD=!0},this.debug=!0,this.params={},this.params.dataIn="",this.params.dataOut="",this.params.decryptIn="",this.params.decryptOut="",this.params.encryptIn="",this.params.encryptOut="",this.params.key="",this.params.iv="",this.params.clear=!0,this.setDefaults(),this.errors="",this.warnings="",this.infos="",this.debugMsg="",this.setParams=function(a){a||(a={});for(var b in a)this.params[b]=a[b]},this.getParams=function(){return this.params},this.getParam=function(a){return this.params[a]||""},this.clearParams=function(){this.params={}},this.getNBits=function(){return this.params.nBits},this.getOutput=function(){return this.params.dataOut},this.setError=function(a){this.error=a},this.appendError=function(a){return this.errors+=a,""},this.getErrors=function(){return this.errors},this.isError=function(){return this.errors.length>0?!0:!1},this.appendInfo=function(a){return this.infos+=a,""},this.getInfos=function(){return this.infos},this.setDebug=function(a){this.debug=a},this.appendDebug=function(a){return this.debugMsg+=a,""},this.isDebug=function(){return this.debug},this.getAllMessages=function(a){var b={lf:"\n",clr_mes:!1,verbose:15};a||(a=b);for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c]);var d="",e="";for(var f in this.params){switch(f){case"encryptOut":e=uc.toByteArray(this.params[f].toString()),e=uc.fragment(e.join(),64,a.lf);break;case"key":case"iv":e=uc.formatHex(this.params[f],48);break;default:e=uc.fragment(this.params[f].toString(),64,a.lf)}d+="<p><b>"+f+"</b>:<pre>"+e+"</pre></p>"}return this.debug&&(d+="debug: "+this.debug+a.lf),this.errors.length>0&&1==(1&a.verbose)&&(d+="Errors:"+a.lf+this.errors+a.lf),this.warnings.length>0&&2==(2&a.verbose)&&(d+="Warnings:"+a.lf+this.warnings+a.lf),this.infos.length>0&&4==(4&a.verbose)&&(d+="Infos:"+a.lf+this.infos+a.lf),this.debug&&8==(8&a.verbose)&&(d+="Debug messages:"+a.lf+this.debugMsg+a.lf),a.clr_mes&&(this.errors=this.infos=this.warnings=this.debug=""),d},this.getRandomBytes=function(b){return a(b)}}function b(a,c){a instanceof b?(this.enc=a.enc,this.pos=a.pos):(this.enc=a,this.pos=c)}function c(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function d(){return new c(null)}function e(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function f(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function g(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function h(a){return pc.charAt(a)}function i(a,b){var c=qc[a.charCodeAt(b)];return null==c?-1:c}function j(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function k(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function l(a){var b=d();return b.fromInt(a),b}function m(a,b){var d;if(16==b)d=4;else if(8==b)d=3;else if(256==b)d=8;else if(2==b)d=1;else if(32==b)d=5;else{if(4!=b)return void this.fromRadix(a,b);d=2}this.t=0,this.s=0;for(var e=a.length,f=!1,g=0;--e>=0;){var h=8==d?255&a[e]:i(a,e);0>h?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&a[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&c.ZERO.subTo(this,this)}function n(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function o(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,i=this.DB-g*this.DB%b;if(g-->0)for(i<this.DB&&(c=this[g]>>i)>0&&(e=!0,f=h(c));g>=0;)b>i?(c=(this[g]&(1<<i)-1)<<b-i,c|=this[--g]>>(i+=this.DB-b)):(c=this[g]>>(i-=b)&d,0>=i&&(i+=this.DB,--g)),c>0&&(e=!0),e&&(f+=h(c));return e?f:"0"}function p(){var a=d();return c.ZERO.subTo(this,a),a}function q(){return this.s<0?this.negate():this}function r(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function s(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function t(){return this.t<=0?0:this.DB*(this.t-1)+s(this[this.t-1]^this.s&this.DM)}function u(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function v(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function w(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function x(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function y(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function z(a,b){var d=this.abs(),e=a.abs(),f=d.t;for(b.t=f+e.t;--f>=0;)b[f]=0;for(f=0;f<e.t;++f)b[f+d.t]=d.am(0,e[f],b,f,0,d.t);b.s=0,b.clamp(),this.s!=a.s&&c.ZERO.subTo(b,b)}function A(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function B(a,b,e){var f=a.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=b&&b.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=d());var h=d(),i=this.s,j=a.s,k=this.DB-s(f[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=e.t,t=r-l,u=null==b?d():b;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e[e.t++]=1,e.subTo(u,e)),c.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--t>=0;){var v=e[--r]==m?this.DM:Math.floor(e[r]*o+(e[r-1]+q)*p);if((e[r]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e[r]<--v;)e.subTo(u,e)}null!=b&&(e.drShiftTo(l,b),i!=j&&c.ZERO.subTo(b,b)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&c.ZERO.subTo(e,e)}}}function C(a){var b=d();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(c.ZERO)>0&&a.subTo(b,b),b}function D(a){this.m=a}function E(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function F(a){return a}function G(a){a.divRemTo(this.m,null,a)}function H(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function I(a,b){a.squareTo(b),this.reduce(b)}function J(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function K(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function L(a){var b=d();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(c.ZERO)>0&&this.m.subTo(b,b),b}function M(a){var b=d();return a.copyTo(b),this.reduce(b),b}function N(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function O(a,b){a.squareTo(b),this.reduce(b)}function P(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Q(){return 0==(this.t>0?1&this[0]:this.s)}function R(a,b){if(a>4294967295||1>a)return c.ONE;var e=d(),f=d(),g=b.convert(this),h=s(a)-1;for(g.copyTo(e);--h>=0;)if(b.sqrTo(e,f),(a&1<<h)>0)b.mulTo(f,g,e);else{var i=e;e=f,f=i}return b.revert(e)}function S(a,b){var c;return c=256>a||b.isEven()?new D(b):new K(b),this.exp(a,c)}function T(){var a=d();return this.copyTo(a),a}function U(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function V(){return 0==this.t?this.s:this[0]<<24>>24}function W(){return 0==this.t?this.s:this[0]<<16>>16}function X(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function Y(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Z(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),e=l(c),f=d(),g=d(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(c+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function $(a,b){this.fromInt(0),null==b&&(b=10);for(var d=this.chunkSize(b),e=Math.pow(b,d),f=!1,g=0,h=0,j=0;j<a.length;++j){var k=i(a,j);0>k?"-"==a.charAt(j)&&0==this.signum()&&(f=!0):(h=b*h+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(b,g)),this.dAddOffset(h,0)),f&&c.ZERO.subTo(this,this)}function _(a,b,d){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(c.ONE.shiftLeft(a-1),hb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(c.ONE.shiftLeft(a-1),this);else{var e=new Array,f=7&a;e.length=(a>>3)+1,b.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function ab(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function bb(a){return 0==this.compareTo(a)}function cb(a){return this.compareTo(a)<0?this:a}function db(a){return this.compareTo(a)>0?this:a}function eb(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function fb(a,b){return a&b}function gb(a){var b=d();return this.bitwiseTo(a,fb,b),b}function hb(a,b){return a|b}function ib(a){var b=d();return this.bitwiseTo(a,hb,b),b}function jb(a,b){return a^b}function kb(a){var b=d();return this.bitwiseTo(a,jb,b),b}function lb(a,b){return a&~b}function mb(a){var b=d();return this.bitwiseTo(a,lb,b),b}function nb(){for(var a=d(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function ob(a){var b=d();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function pb(a){var b=d();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function qb(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function rb(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+qb(this[a]);return this.s<0?this.t*this.DB:-1}function sb(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function tb(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=sb(this[c]^b);return a}function ub(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function vb(a,b){var d=c.ONE.shiftLeft(a);return this.bitwiseTo(d,b,d),d}function wb(a){return this.changeBit(a,hb)}function xb(a){return this.changeBit(a,lb)}function yb(a){return this.changeBit(a,jb)}function zb(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Ab(a){var b=d();return this.addTo(a,b),b}function Bb(a){var b=d();return this.subTo(a,b),b}function Cb(a){var b=d();return this.multiplyTo(a,b),b}function Db(a){var b=d();return this.divRemTo(a,b,null),b}function Eb(a){var b=d();return this.divRemTo(a,null,b),b}function Fb(a){var b=d(),c=d();return this.divRemTo(a,b,c),new Array(b,c)}function Gb(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Hb(a,b){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}function Ib(){}function Jb(a){return a}function Kb(a,b,c){a.multiplyTo(b,c)}function Lb(a,b){a.squareTo(b)}function Mb(a){return this.exp(a,new Ib)}function Nb(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function Ob(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Pb(a){this.r2=d(),this.q3=d(),c.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Qb(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=d();return a.copyTo(b),this.reduce(b),b}function Rb(a){return a}function Sb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Tb(a,b){a.squareTo(b),this.reduce(b)}function Ub(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Vb(a,b){var c,e,f=a.bitLength(),g=l(1);if(0>=f)return g;c=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new D(b):b.isEven()?new Pb(b):new K(b);var h=new Array,i=3,j=c-1,k=(1<<c)-1;if(h[1]=e.convert(this),c>1){var m=d();for(e.sqrTo(h[1],m);k>=i;)h[i]=d(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,r=d();for(f=s(a[p])-1;p>=0;){for(f>=j?n=a[p]>>f-j&k:(n=(a[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a[p-1]>>this.DB+f-j)),i=c;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,r),e.sqrTo(r,g),i-=2;i>0?e.sqrTo(g,r):(o=g,g=r,r=o),e.mulTo(r,h[n],g)}for(;p>=0&&0==(a[p]&1<<f);)e.sqrTo(g,r),o=g,g=r,r=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Wb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Xb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function Yb(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return c.ZERO;for(var d=a.clone(),e=this.clone(),f=l(1),g=l(0),h=l(0),i=l(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),b?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),b?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(a,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),b&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),b&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(c.ONE)?c.ZERO:i.compareTo(a)>=0?i.subtract(a):i.signum()<0?(i.addTo(a,i),i.signum()<0?i.add(a):i):i}function Zb(a){var b,c=this.abs();if(1==c.t&&c[0]<=rc[rc.length-1]){for(b=0;b<rc.length;++b)if(c[0]==rc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<rc.length;){for(var d=rc[b],e=b+1;e<rc.length&&sc>d;)d*=rc[e++];for(d=c.modInt(d);e>b;)if(d%rc[b++]==0)return!1}return c.millerRabin(a)}function $b(a){var b=this.subtract(c.ONE),e=b.getLowestSetBit();if(0>=e)return!1;var f=b.shiftRight(e);a=a+1>>1,a>rc.length&&(a=rc.length);for(var g=d(),h=0;a>h;++h){g.fromInt(rc[h]);var i=g.modPow(f,this);if(0!=i.compareTo(c.ONE)&&0!=i.compareTo(b)){for(var j=1;j++<e&&0!=i.compareTo(b);)if(i=i.modPowInt(2,this),0==i.compareTo(c.ONE))return!1;if(0!=i.compareTo(b))return!1}}return!0}function _b(){this.i=0,this.j=0,this.S=new Array}function ac(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(c=0,b=0;256>b;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0}function bc(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]}function cc(){return new _b}function dc(){if(this.rng_state,this.rng_pool,this.rng_pptr,this.rng_seed_int=function(a){this.rng_pool[this.rng_pptr++]^=255&a,this.rng_pool[this.rng_pptr++]^=a>>8&255,this.rng_pool[this.rng_pptr++]^=a>>16&255,this.rng_pool[this.rng_pptr++]^=a>>24&255,this.rng_pptr>=tc&&(this.rng_pptr-=tc)},this.rng_seed_time=function(){this.rng_seed_int((new Date).getTime())},null==this.rng_pool){this.rng_pool=new Array,this.rng_pptr=0;var a;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var b=window.crypto.random(32);for(a=0;a<b.length;++a)this.rng_pool[this.rng_pptr++]=255&b.charCodeAt(a)}for(;this.rng_pptr<tc;)a=Math.floor(65536*Math.random()),this.rng_pool[this.rng_pptr++]=a>>>8,this.rng_pool[this.rng_pptr++]=255&a;this.rng_pptr=0,this.rng_seed_time()}this.rng_get_byte=function(){if(null==this.rng_state){for(this.rng_seed_time(),this.rng_state=cc(),this.rng_state.init(this.rng_pool),this.rng_pptr=0;this.rng_pptr<this.rng_pool.length;++this.rng_pptr)this.rng_pool[this.rng_pptr]=0;this.rng_pptr=0}return this.rng_state.next()},this.nextBytes=function(a){var b;for(b=0;b<a.length;++b)a[b]=this.rng_get_byte()}}function ec(a,b){return new c(a,b)}function fc(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;)e+=String.fromCharCode(c[d]);return e}function gc(a,b){if(b<a.length+11)return alert("Message too long for RSA"),null;for(var d=new Array,e=a.length-1;e>=0&&b>0;)d[--b]=a.charCodeAt(e--);d[--b]=0;for(var f=new dc,g=new Array;b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);d[--b]=g[0]}return d[--b]=2,d[--b]=0,new c(d)}function hc(a){var b=a.split("\n"),c=!1,d=!1,e="",f={};f.info="",f.salt="",f.iv=null,f.b64="",f.aes=!1,f.mode="",f.bits=0;for(var g=0;g<b.length;g++)switch(e=b[g].substr(0,9),1===g&&"Proc-Type"!==e&&0===e.indexOf("M")&&(d=!0),e){case"-----BEGI":c=!0;break;case"Proc-Type":c&&(f.info=b[g]);break;case"DEK-Info:":if(c){var h=b[g].split(","),i=h[0].split(": "),j=i[1].split("-");f.aes="AES"===j[0]?!0:!1,f.mode=j[2],f.bits=parseInt(j[1]),f.salt=h[1].substr(0,16),f.iv=h[1]}break;case"":c&&(d=!0);break;case"-----END ":c&&(d=!1,c=!1);break;default:c&&d&&(f.b64+=uc.stripLineFeeds(b[g]))}return f}function ic(b,c){var d=hc(c),e=uc.decodeBase64(d.b64),f=new a.RSA,g=a.ASN1.decode(uc.toByteArray(e)),h=g.toHexTree();f.setPublicKeyFromASN(h);var i=f.encrypt(b);return uc.fragment(uc.encodeBase64(uc.convertFromHex(i)),64)}b.prototype.parseStringHex=function(a,b){"undefined"==typeof b&&(b=this.enc.length);for(var c="",d=a;b>d;++d){var e=this.get(d);c+=this.hexDigits.charAt(e>>4)+this.hexDigits.charAt(15&e)}return c},b.prototype.get=function(a){if(void 0===a&&(a=this.pos++),a>=this.enc.length)throw"Requesting byte offset "+a+" on a stream of length "+this.enc.length;return this.enc[a]},b.prototype.hexDigits="0123456789ABCDEF",b.prototype.hexDump=function(a,b){for(var c="",d=a;b>d;++d){var e=this.get(d);c+=this.hexDigits.charAt(e>>4)+this.hexDigits.charAt(15&e),7==(15&d)&&(c+=" "),c+=15==(15&d)?"\n":" "}return c},b.prototype.parseStringISO=function(a,b){for(var c="",d=a;b>d;++d)c+=String.fromCharCode(this.get(d));return c},b.prototype.parseStringUTF=function(a,b){for(var c="",d=a;b>d;){var e=this.get(d++);c+=String.fromCharCode(128>e?e:e>191&&224>e?(31&e)<<6|63&this.get(d++):(15&e)<<12|(63&this.get(d++))<<6|63&this.get(d++))}return c},b.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,b.prototype.parseTime=function(a,b){var c=this.parseStringISO(a,b),d=this.reTime.exec(c);return d?(c=d[1]+"-"+d[2]+"-"+d[3]+" "+d[4],d[5]&&(c+=":"+d[5],d[6]&&(c+=":"+d[6],d[7]&&(c+="."+d[7]))),d[8]&&(c+=" UTC","Z"!=d[8]&&(c+=d[8],d[9]&&(c+=":"+d[9]))),c):"Unrecognized time: "+c},b.prototype.parseInteger=function(a,b){if(b-a>4)return void 0;for(var c=0,d=a;b>d;++d)c=c<<8|this.get(d);return c},b.prototype.parseOID=function(a,b){for(var c,d=0,e=0,f=a;b>f;++f){var g=this.get(f);d=d<<7|127&g,e+=7,128&g||(void 0===c?c=parseInt(d/40)+"."+d%40:c+="."+(e>=31?"big":d),d=e=0),c+=String.fromCharCode()}return c},"undefined"!=typeof a&&(a.ASN1=function(a,b,c,d,e){this.stream=a,this.header=b,this.length=c,this.tag=d,this.sub=e},a.ASN1.prototype.toHexTree=function(){var a={};if(a.type=this.typeName(),"SEQUENCE"!=a.type&&(a.value=this.stream.parseStringHex(this.posContent(),this.posEnd())),null!==this.sub){a.sub=[];for(var b=0,c=this.sub.length;c>b;++b)a.sub[b]=this.sub[b].toHexTree()}return a},a.ASN1.prototype.typeName=function(){if(void 0===this.tag)return"unknown";var a=this.tag>>6,b=(this.tag>>5&1,31&this.tag);switch(a){case 0:switch(b){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+b.toString(16)}break;case 1:return"Application_"+b.toString(16);case 2:return"["+b+"]";case 3:return"Private_"+b.toString(16)}},a.ASN1.prototype.content=function(){if(void 0===this.tag)return null;var a=this.tag>>6;if(0!==a)return null;var b=31&this.tag,c=this.posContent(),d=Math.abs(this.length);switch(b){case 1:return 0===this.stream.get(c)?"false":"true";case 2:return this.stream.parseInteger(c,c+d);case 6:return this.stream.parseOID(c,c+d);case 12:return this.stream.parseStringUTF(c,c+d);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(c,c+d);case 23:case 24:return this.stream.parseTime(c,c+d)}return null},a.ASN1.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},a.ASN1.prototype.print=function(a){if(void 0===a&&(a=""),document.writeln(a+this),null!=this.sub){a+="  ";for(var b=0,c=this.sub.length;c>b;++b)this.sub[b].print(a)}},a.ASN1.prototype.toPrettyString=function(a){void 0==a&&(a="");var b=a+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(b+="+"),b+=this.length,32&this.tag?b+=" (constructed)":3!=this.tag&&4!=this.tag||null==this.sub||(b+=" (encapsulates)"),b+="\n",null!=this.sub){a+="  ";for(var c=0,d=this.sub.length;d>c;++c)b+=this.sub[c].toPrettyString(a)}return b},a.ASN1.prototype.toDOM=function(){var a=document.createElement("div");a.className="node",a.asn1=this;var b=document.createElement("div");b.className="head";var c=this.typeName();b.innerHTML=c,a.appendChild(b),this.head=b;var d=document.createElement("div");d.className="value",c="Offset: "+this.stream.pos+"<br/>",c+="Length: "+this.header+"+",c+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?c+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null==this.sub||(c+="<br/>(encapsulates)");var e=this.content();if(null!=e&&(c+="<br/>Value:<br/><b>"+e+"</b>","object"==typeof oids&&6==this.tag)){var f=oids[e];f&&(f.d&&(c+="<br/>"+f.d),f.c&&(c+="<br/>"+f.c),f.w&&(c+="<br/>(warning!)"))}d.innerHTML=c,a.appendChild(d);var g=document.createElement("div");if(g.className="sub",null!=this.sub)for(var h=0,i=this.sub.length;i>h;++h)g.appendChild(this.sub[h].toDOM());return a.appendChild(g),b.switchNode=a,b.onclick=function(){var a=this.switchNode;a.className="node collapsed"==a.className?"node":"node collapsed"},a},a.ASN1.prototype.posStart=function(){return this.stream.pos},a.ASN1.prototype.posContent=function(){return this.stream.pos+this.header},a.ASN1.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},a.ASN1.prototype.toHexDOM_sub=function(a,b,c,d,e){if(!(d>=e)){var f=document.createElement("span");f.className=b,f.appendChild(document.createTextNode(c.hexDump(d,e))),a.appendChild(f)}},a.ASN1.prototype.toHexDOM=function(){var a=document.createElement("span");if(a.className="hex",this.head.hexNode=a,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},this.toHexDOM_sub(a,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(a,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null==this.sub)a.appendChild(document.createTextNode(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var b=this.sub[0],c=this.sub[this.sub.length-1];this.toHexDOM_sub(a,"intro",this.stream,this.posContent(),b.posStart());for(var d=0,e=this.sub.length;e>d;++d)a.appendChild(this.sub[d].toHexDOM());this.toHexDOM_sub(a,"outro",this.stream,c.posEnd(),this.posEnd())}return a},a.ASN1.decodeLength=function(a){var b=a.get(),c=127&b;
if(c==b)return c;if(c>3)throw"Length over 24 bits not supported at position "+(a.pos-1);if(0==c)return-1;b=0;for(var d=0;c>d;++d)b=b<<8|a.get();return b},a.ASN1.hasContent=function(c,d,e){if(32&c)return!0;if(3>c||c>4)return!1;var f=new b(e);3==c&&f.get();var g=f.get();if(g>>6&1)return!1;try{var h=a.ASN1.decodeLength(f);return f.pos-e.pos+h==d}catch(i){return!1}},a.ASN1.decode=function(c){c instanceof b||(c=new b(c,0));var d=new b(c),e=c.get(),f=a.ASN1.decodeLength(c),g=c.pos-d.pos,h=null;if(a.ASN1.hasContent(e,f,c)){var i=c.pos;if(3==e&&c.get(),h=[],f>=0){for(var j=i+f;c.pos<j;)h[h.length]=a.ASN1.decode(c);if(c.pos!=j)throw"Content size is not correct for container starting at offset "+i}else try{for(;;){var k=a.ASN1.decode(c);if(0==k.tag)break;h[h.length]=k}f=i-c.pos}catch(l){throw"Exception while decoding undefined length content: "+l}}else c.pos+=f;return new a.ASN1(d,g,f,e,h)},a.ASN1.test=function(){for(var c=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],d=0,e=c.length;e>d;++d){var f=new b(c[d].value,0),g=a.ASN1.decodeLength(f);g!=c[d].expected&&document.write("In test["+d+"] expected "+c[d].expected+" got "+g+"\n")}});var jc,kc=0xdeadbeefcafe,lc=15715070==(16777215&kc);lc&&"Microsoft Internet Explorer"==navigator.appName?(c.prototype.am=f,jc=30):lc&&"Netscape"!=navigator.appName?(c.prototype.am=e,jc=26):(c.prototype.am=g,jc=28),c.prototype.DB=jc,c.prototype.DM=(1<<jc)-1,c.prototype.DV=1<<jc;var mc=52;c.prototype.FV=Math.pow(2,mc),c.prototype.F1=mc-jc,c.prototype.F2=2*jc-mc;var nc,oc,pc="0123456789abcdefghijklmnopqrstuvwxyz",qc=new Array;for(nc="0".charCodeAt(0),oc=0;9>=oc;++oc)qc[nc++]=oc;for(nc="a".charCodeAt(0),oc=10;36>oc;++oc)qc[nc++]=oc;for(nc="A".charCodeAt(0),oc=10;36>oc;++oc)qc[nc++]=oc;D.prototype.convert=E,D.prototype.revert=F,D.prototype.reduce=G,D.prototype.mulTo=H,D.prototype.sqrTo=I,K.prototype.convert=L,K.prototype.revert=M,K.prototype.reduce=N,K.prototype.mulTo=P,K.prototype.sqrTo=O,c.prototype.copyTo=j,c.prototype.fromInt=k,c.prototype.fromString=m,c.prototype.clamp=n,c.prototype.dlShiftTo=u,c.prototype.drShiftTo=v,c.prototype.lShiftTo=w,c.prototype.rShiftTo=x,c.prototype.subTo=y,c.prototype.multiplyTo=z,c.prototype.squareTo=A,c.prototype.divRemTo=B,c.prototype.invDigit=J,c.prototype.isEven=Q,c.prototype.exp=R,c.prototype.toString=o,c.prototype.negate=p,c.prototype.abs=q,c.prototype.compareTo=r,c.prototype.bitLength=t,c.prototype.mod=C,c.prototype.modPowInt=S,c.ZERO=l(0),c.ONE=l(1),Ib.prototype.convert=Jb,Ib.prototype.revert=Jb,Ib.prototype.mulTo=Kb,Ib.prototype.sqrTo=Lb,Pb.prototype.convert=Qb,Pb.prototype.revert=Rb,Pb.prototype.reduce=Sb,Pb.prototype.mulTo=Ub,Pb.prototype.sqrTo=Tb;var rc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],sc=(1<<26)/rc[rc.length-1];c.prototype.chunkSize=X,c.prototype.toRadix=Z,c.prototype.fromRadix=$,c.prototype.fromNumber=_,c.prototype.bitwiseTo=eb,c.prototype.changeBit=vb,c.prototype.addTo=zb,c.prototype.dMultiply=Gb,c.prototype.dAddOffset=Hb,c.prototype.multiplyLowerTo=Nb,c.prototype.multiplyUpperTo=Ob,c.prototype.modInt=Xb,c.prototype.millerRabin=$b,c.prototype.clone=T,c.prototype.intValue=U,c.prototype.byteValue=V,c.prototype.shortValue=W,c.prototype.signum=Y,c.prototype.toByteArray=ab,c.prototype.equals=bb,c.prototype.min=cb,c.prototype.max=db,c.prototype.and=gb,c.prototype.or=ib,c.prototype.xor=kb,c.prototype.andNot=mb,c.prototype.not=nb,c.prototype.shiftLeft=ob,c.prototype.shiftRight=pb,c.prototype.getLowestSetBit=rb,c.prototype.bitCount=tb,c.prototype.testBit=ub,c.prototype.setBit=wb,c.prototype.clearBit=xb,c.prototype.flipBit=yb,c.prototype.add=Ab,c.prototype.subtract=Bb,c.prototype.multiply=Cb,c.prototype.divide=Db,c.prototype.remainder=Eb,c.prototype.divideAndRemainder=Fb,c.prototype.modPow=Vb,c.prototype.modInverse=Yb,c.prototype.pow=Mb,c.prototype.gcd=Wb,c.prototype.isProbablePrime=Zb,_b.prototype.init=ac,_b.prototype.next=bc;var tc=256;"undefined"!=typeof a&&"undefined"!=typeof c&&"undefined"!=typeof dc&&"undefined"!=typeof _b&&(a.RSA=function(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null},a.RSA.prototype.doPrivate=function(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)},a.RSA.prototype.setPublic=function(a,b,c){"undefined"==typeof c&&(c=16),null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=ec(a,c),this.e=parseInt(b,c)):alert("Invalid RSA public key")},a.RSA.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},a.RSA.prototype.encryptRaw=function(a){var b=gc(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPublic(b);if(null==c)return null;var d=c.toString(16);return 0==(1&d.length)?d:"0"+d},a.RSA.prototype.encrypt=function(a){return a=uc.encodeBase64(a),this.encryptRaw(a)},a.RSA.prototype.decryptRaw=function(a){var b=ec(a,16),c=this.doPrivate(b);return null==c?null:fc(c,this.n.bitLength()+7>>3)},a.RSA.prototype.decrypt=function(a){var b=this.decryptRaw(a);return b=b?uc.decodeBase64(b):""},a.RSA.prototype.setPrivate=function(a,b,c,d){"undefined"==typeof d&&(d=16),null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=ec(a,d),this.e=parseInt(b,d),this.d=ec(c,d)):alert("Invalid RSA private key")},a.RSA.prototype.setPrivateEx=function(a,b,c,d,e,f,g,h,i){"undefined"==typeof i&&(i=16),null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=ec(a,i),this.e=parseInt(b,i),this.d=ec(c,i),this.p=ec(d,i),this.q=ec(e,i),this.dmp1=ec(f,i),this.dmq1=ec(g,i),this.coeff=ec(h,i)):alert("Invalid RSA private key")},a.RSA.prototype.generate=function(a,b){var d=new dc,e=a>>1;this.e=parseInt(b,16);for(var f=new c(b,16);;){for(;this.p=new c(a-e,1,d),0!=this.p.subtract(c.ONE).gcd(f).compareTo(c.ONE)||!this.p.isProbablePrime(10););for(;this.q=new c(e,1,d),0!=this.q.subtract(c.ONE).gcd(f).compareTo(c.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var g=this.p;this.p=this.q,this.q=g}var h=this.p.subtract(c.ONE),i=this.q.subtract(c.ONE),j=h.multiply(i);if(0==j.gcd(f).compareTo(c.ONE)){this.n=this.p.multiply(this.q),this.d=f.modInverse(j),this.dmp1=this.d.mod(h),this.dmq1=this.d.mod(i),this.coeff=this.q.modInverse(this.p);break}}},a.RSA.prototype.getASNData=function(a){var b=[],c=0;if(a.value&&"INTEGER"==a.type&&(b[c++]=a.value),a.sub)for(var d=0;d<a.sub.length;d++)b=b.concat(this.getASNData(a.sub[d]));return b},a.RSA.prototype.setKeyFromASN=function(a,b){var c=["N","E","D","P","Q","DP","DQ","C"],d={},e=this.getASNData(b);switch(a){case"Public":case"public":for(var f=0;f<e.length;f++)d[c[f]]=e[f].toLowerCase();this.setPublic(d.N,d.E,16);break;case"Private":case"private":for(var f=1;f<e.length;f++)d[c[f-1]]=e[f].toLowerCase();this.setPrivateEx(d.N,d.E,d.D,d.P,d.Q,d.DP,d.DQ,d.C,16)}},a.RSA.prototype.setPublicKeyFromASN=function(a){this.setKeyFromASN("public",a)},a.RSA.prototype.setPrivateKeyFromASN=function(a){this.setKeyFromASN("private",a)},a.RSA.prototype.getParameters=function(){var a={};return null!=this.n&&(a.n=this.n),a.e=this.e,null!=this.d&&(a.d=this.d),null!=this.p&&(a.p=this.p),null!=this.q&&(a.q=this.q),null!=this.dmp1&&(a.dmp1=this.dmp1),null!=this.dmq1&&(a.dmq1=this.dmq1),null!=this.coeff&&(a.c=this.coeff),a});var uc={};return uc.encodeBase64=function(a,b){a||(a="");var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b="undefined"==typeof b?!1:b;var d,e,f,g,h,i,j,k,l,m,n,o=[],p="";if(m=b?uc.encodeUTF8(a):a,l=m.length%3,l>0)for(;l++<3;)p+="=",m+="\x00";for(l=0;l<m.length;l+=3)d=m.charCodeAt(l),e=m.charCodeAt(l+1),f=m.charCodeAt(l+2),g=d<<16|e<<8|f,h=g>>18&63,i=g>>12&63,j=g>>6&63,k=63&g,o[l/3]=c.charAt(h)+c.charAt(i)+c.charAt(j)+c.charAt(k);return n=o.join(""),n=n.slice(0,n.length-p.length)+p},uc.decodeBase64=function(a,b){a||(a="");var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b="undefined"==typeof b?!1:b;var d,e,f,g,h,i,j,k,l,m,n=[];m=b?uc.decodeUTF8(a):a;for(var o=0;o<m.length;o+=4)g=c.indexOf(m.charAt(o)),h=c.indexOf(m.charAt(o+1)),i=c.indexOf(m.charAt(o+2)),j=c.indexOf(m.charAt(o+3)),k=g<<18|h<<12|i<<6|j,d=k>>>16&255,e=k>>>8&255,f=255&k,n[o/4]=String.fromCharCode(d,e,f),64==j&&(n[o/4]=String.fromCharCode(d,e)),64==i&&(n[o/4]=String.fromCharCode(d));return l=n.join(""),l=b?uc.decodeUTF8(l):l},uc.encodeUTF8=function(a){return a||(a=""),a=a.replace(/[\u0080-\u07ff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(192|b>>6,128|63&b)}),a=a.replace(/[\u0800-\uffff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|63&b)})},uc.decodeUTF8=function(a){return a||(a=""),a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){var b=(31&a.charCodeAt(0))<<6|63&a.charCodeAt(1);return String.fromCharCode(b)}),a=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){var b=(15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2);return String.fromCharCode(b)})},uc.convertToHex=function(a){a||(a="");for(var b="",c="",d=0;d<a.length;d++)c=a.charCodeAt(d).toString(16),b+=1==c.length?"0"+c:c;return b},uc.convertFromHex=function(a){a||(a="");for(var b="",c=0;c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substring(c,c+2),16));return b},uc.stripLineFeeds=function(a){a||(a="");var b="";return b=a.replace(/\n/g,""),b=b.replace(/\r/g,"")},uc.toByteArray=function(a){a||(a="");for(var b=[],c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b},uc.fragment=function(a,b,c){if(a||(a=""),!b||b>=a.length)return a;c||(c="\n");for(var d="",e=0;e<a.length;e+=b)d+=a.substr(e,b)+c;return d},uc.formatHex=function(a,b){a||(a=""),b||(b=45);for(var c="",d=a.toLowerCase(),e=0;e<d.length;e+=2)c+=d.substr(e,2)+":";return d=this.fragment(c,b)},uc.byteArray2String=function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},ic});